use [order]
go

create procedure sp_fillOrderLeimuid
as

declare @id numeric(19,0)
declare @yunshu varchar(255)
declare @leimuId numeric(19,0)
declare @cur cursor

begin
	set @cur = cursor for select id, yunshu from orderinfo where leimuid is null
	open @cur
	fetch next from @cur into @id, @yunshu
	while @@fetch_status = 0
	begin
		select @leimuId = id from leimu where leimu like '%' + @yunshu + '%'
		if @leimuId != null
		begin
			update orderinfo set leimuid = @leimuId where id = @id
		end
		fetch next from @cur into @id, @yunshu
	end
close @cur
end
go

exec sp_fillOrderLeimuid
go

drop procedure sp_fillOrderLeimuid
go